<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CVSS Risk Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-light">
<div class="container py-5">
  <h1 class="text-center mb-4">üìä CVSS Risk Analysis Dashboard</h1>

  <div class="mb-4 text-center">
    <a href="/" class="btn btn-secondary">‚¨ÖÔ∏è Kembali ke Scanner</a>
  </div>

  <!-- Matrix Tables -->
  <div class="row g-4 mb-5">
    <div class="col-md-4">
      <h5 class="text-center">Access Vector (AV)</h5>
      <table class="table table-bordered table-striped text-center">
        {% for key, val in av_matrix.items() %}
        <tr><td>{{ key }}</td><td>{{ val }}</td></tr>
        {% endfor %}
      </table>
    </div>
    <div class="col-md-4">
      <h5 class="text-center">Access Complexity (AC)</h5>
      <table class="table table-bordered table-striped text-center">
        {% for key, val in ac_matrix.items() %}
        <tr><td>{{ key }}</td><td>{{ val }}</td></tr>
        {% endfor %}
      </table>
    </div>
    <div class="col-md-4">
      <h5 class="text-center">Authentication (PR)</h5>
      <table class="table table-bordered table-striped text-center">
        {% for key, val in au_matrix.items() %}
        <tr><td>{{ key }}</td><td>{{ val }}</td></tr>
        {% endfor %}
      </table>
    </div>
  </div>

  <!-- Line Chart Impact -->
  <div class="card p-4">
    <h5 class="mb-4 fw-bold text-center">Tren Impact (7 Hari Terakhir)</h5>
    <canvas id="impactChart"></canvas>
  </div>
</div>

<script>
  const labels = {{ impact_daily.keys() | list | tojson }};
  const dataC = {{ impact_daily.values() | map(attribute='C') | list | tojson }};
  const dataI = {{ impact_daily.values() | map(attribute='I') | list | tojson }};
  const dataA = {{ impact_daily.values() | map(attribute='A') | list | tojson }};

  new Chart(document.getElementById('impactChart').getContext('2d'), {
      type: 'line',
      data: {
          labels: labels,
          datasets: [
              {
                  label: 'Confidentiality',
                  data: dataC,
                  borderColor: '#0d6efd',
                  backgroundColor: 'rgba(13, 110, 253, 0.2)',
                  tension: 0.3
              },
              {
                  label: 'Integrity',
                  data: dataI,
                  borderColor: '#dc3545',
                  backgroundColor: 'rgba(220, 53, 69, 0.2)',
                  tension: 0.3
              },
              {
                  label: 'Availability',
                  data: dataA,
                  borderColor: '#ffc107',
                  backgroundColor: 'rgba(255, 193, 7, 0.2)',
                  tension: 0.3
              }
          ]
      },
      options: {
          responsive: true,
          plugins: {
              legend: {
                  position: 'top'
              }
          }
      }
  });
</script>
</body>
</html>
